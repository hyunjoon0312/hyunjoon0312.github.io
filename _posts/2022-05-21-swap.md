---
title:  "[LINUX] 5분만에 스왑(SWAP) 메모리 늘리는 방법"
excerpt: "Linux OS에서 스왑(SWAP) 메모리의 크기를 늘리는 방법"
toc: true
toc_sticky: true
toc_label: "목차"

categories:
  - Linux
tags:
  - Linux


---

리눅스 시스템을 사용하다 보면 종종 물리 메모리(RAM) 공간이 부족하게 될 경우 발생합니다. 가장 좋은 방법으로는 메모리 증설을 해주면 좋지만 일시적인 메모리 부족일 때도 있고, 결정적으로 RAM의 교체가 필요하기 때문에 쉽지 않습니다. 이렇게 물리 메모리가 부족할 경우를 대비해서 잡혀있는 공간이 바로 스왑(swap) 메모리 공간 입니다.  



스왑 메모리는 하드 디스크(HDD)의 일부 공간을 물리 메모리 처럼 사용할 수 있도록 예약해 놓은 공간 입니다. 하지만 하드 디스크 공간이기 RAM을 사용할 때와는 비교도 되지 않을 정도로 성능이 떨어집니다. 즉, 비상시에 사용하기 위해 만들어 놓은 공간입니다.   



이번 포스팅에서는 이런 스왑 메모리 공간이 너무 작게 설정되어 있어 추가로 증설이 필요할 경우 어떻게 하면 되는지에 대해 말씀드리도록 하겠습니다.  



## 메모리 구성 확인하기

![swap](https://drive.google.com/uc?export=view&id=1EH6DkmqahGV6mutM0M-Z_TJRDyKk8tHc)

커맨드 창에서 free -h 명령어를 통해서 현재 시스템의 메모리 구성을 확인 할 수 있습니다. 제가 VM으로 구성한 시스템은 총 9.7GB로 구성 되어 있으며 현재 1GB를 사용 중이고 사용 가능한 메모리는 8.4GB 입니다.  



그리고 메모리 구성 아래 스왑 영역을 보시면 총 2.0GB로 스왑이 구성되어 있고 사용 중인 공간은 0이며, 따라서 2GB의 공간을 사용 가능한 것을 확인 할 수 있습니다.  



## 스왑(swap) 메모리 늘리기

이번 포스팅에서는 기존 2GB로 잡혀 있는 스왑 메모리 크기를 5GB로 변경해 볼 것 입니다. 가장 먼저 스왑 공간을 늘리기 위해서는 스왑 공간으로 사용할 빈 파일을 만들어 주어야 합니다. 이때 일반적으로 파일명은 /swapfile 로 만들어 줍니다.  

```bash
fallocate -l 5G /swapfile
chmod 600 /swapfile
ls -alh /swapfile 
-rw------- 1 root root 5.0G May 27  2021 /swapfile
```

기존의 스왑 사용 형식이 파일로 되어 있을 경우 동일한 이름의 파일이 있을 수 있습니다. 그럴 경우 원하시는 임의 파일명으로 진행을 하셔도 무관 합니다. 이렇게 5GB의 파일이 생성되었으면 이제 스왑 공간으로 만들어 줍니다.   

```bash
mkswap /swapfile
mkswap: /swapfile: insecure permissions 0644, 0600 suggested.
Setting up swapspace version 1, size = 5 GiB (5368705024 bytes)
no label, UUID=d03ca4ad-3c33-4eb6-b92f-b794adab1182
```

스왑 공간 생성이 완료되었으면 시스템에 적용을 해줍니다. 해당 방법은 우선 임시로 즉각적으로 스왑 공간을 적용시키는 방법 입니다.  

```bash
swapon /swapfile
```

그리고 정상적으로 적용이 되었는지 확인을 해봅니다.  

```bash
free -h
              total        used        free      shared  buff/cache   available
Mem:           9.7G        1.4G        6.0G        7.7M        2.4G        8.0G
Swap:          5.0G          0B        5.0G
```

이렇게 정상적으로 스왑 공간이 2GB에서 5GB로 늘어난 것을 확인할 수 있습니다.  



만약 기존에 파일 형식으로 스왑이 적용되어 있을 경우 기존의 스왑파일은 아래와 같이 삭제해주어야 원하는 크기의 스왑이 생성 됩니다.   

```bash
swapoff -v /swapfile
swapoff on /swapfile
rm /swapfile
```

마지막으로 시스템 재부팅시에도 스왑 공간이 유지되게 하고 싶다면 /etc/fstab에 스왑공간을 설정해주어야 합니다.  

```bash
vi /etc/fstab
/swapfile swap swap defaults 0 0
```

여기까지 스왑 공간을 늘리는 방법에 대해서 알아보았습니다. 스왑 공간을 증설하는 경우가 많지는 않지만 알아 두신다면 유용하게 사용하실 수 있으실 것이라 생각 됩니다.  



참고 : https://manpages.ubuntu.com/manpages/jammy/en/man8/swapon.8.html